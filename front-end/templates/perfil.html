<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de {{ current_user.nomeUsuario }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <!-- Botão para voltar à Home -->
        <a href="{{ url_for('home.home') }}" class="btn btn-secondary mb-3">Voltar à Home</a>

        <h1>Perfil de {{ current_user.nomeUsuario }}</h1>

        <!-- Alterar Imagem de Perfil -->
        <h2>Alterar Foto de Perfil</h2>
        <img src="{{ current_user.foto_perfil }}" alt="Foto de Perfil" width="150" height="150" class="rounded-circle mb-3">
        <form action="{{ url_for('usuario_route.upload_foto_perfil') }}" method="POST" enctype="multipart/form-data">
            <label for="imagem">Selecione uma nova foto:</label>
            <input type="file" name="imagem" id="imagem" accept="image/*" required>
            <button type="submit" class="btn btn-primary mt-2">Atualizar Foto</button>
        </form>

        <!-- Alterar Nome de Usuário -->
        <h2 class="mt-5">Alterar Nome de Usuário</h2>
        <form action="{{ url_for('usuario_route.atualizar_nome') }}" method="POST">
            <div class="mb-3">
                <label for="nomeUsuario">Nome de Usuário Atual:</label>
                <input type="text" name="nomeUsuario" id="nomeUsuario" value="{{ current_user.nomeUsuario }}" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary">Atualizar Nome</button>
        </form>

        <!-- Minhas Perguntas -->
        <h2 class="mt-5">Minhas Perguntas</h2>
        <ul class="list-group mb-5">
            {% for pergunta in perguntas %}
            <li class="list-group-item">
                <a href="{{ url_for('pergunta_route.pergunta_detalhe', pergunta_id=pergunta.codigo) }}">
                    {{ pergunta.titulo }}
                </a>
                <small class="text-muted"> - Publicada em {{ pergunta.data_criacao.strftime('%d/%m/%Y') }}</small>
            </li>
            {% else %}
            <p class="text-muted">Você ainda não fez nenhuma pergunta.</p>
            {% endfor %}
        </ul>

        <!-- Meus Blogs -->
        <h2>Meus Blogs</h2>
        <ul class="list-group mb-5">
            {% for blog in blogs %}
            <li class="list-group-item">
                <a href="{{ url_for('blog_route.detalhes_blog', blog_id=blog.codigo) }}">
                    {{ blog.titulo }}
                </a>
                <small class="text-muted"> - Publicado em {{ blog.data_criacao.strftime('%d/%m/%Y') }}</small>
            </li>
            {% else %}
            <p class="text-muted">Você ainda não escreveu nenhum blog.</p>
            {% endfor %}
        </ul>

        <!-- Minhas Respostas/Comentários -->
        <h2>Minhas Respostas e Comentários</h2>
        <ul class="list-group">
            {% for resposta in respostas %}
            <li class="list-group-item">
                <strong>Comentário:</strong> {{ resposta.comentario }}<br>
                <small class="text-muted">Comentado na pergunta: 
                    <a href="{{ url_for('pergunta_route.pergunta_detalhe', pergunta_id=resposta.codPergunta) }}">
                        {{ resposta.pergunta_relacionada.titulo }}
                    </a> - Publicado em {{ resposta.data_criacao.strftime('%d/%m/%Y') }}
                </small>
            </li>
            {% else %}
            <p class="text-muted">Você ainda não respondeu a nenhuma pergunta ou comentou em blogs.</p>
            {% endfor %}
        </ul>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
